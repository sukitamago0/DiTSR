# DiTSR v5 训练流程（复原 → 超分）

## 目标
v5 的设计目标是把模型从“生成型扩散”转为“强约束复原扩散”，并与评测管线严格对齐。

## 阶段 A（复原 / lq512 → gt512）
- **验证**：固定 valpack + lq512，确保训练验证与测试一致。
- **文本条件**：关闭（force drop）。
- **LR-consistency**：每步计算（强约束）。
- **LQ-init**：训练与推理一致启用。
- **损失结构**：以 L1 + LR-consistency 为主，LPIPS 低权重、延迟引入。

**进入超分门槛（建议）**  
valpack(lq512) 上 PSNR_Y ≥ identity − 0.2 dB，且 LPIPS ≤ identity。

## 阶段 B（x4 SR / lq128 → gt512）
- **验证**：固定 valpack + lq128。
- 继承阶段 A 的强约束设置。
- 逐步增加感知损失以补足高频。

## 实施说明
- v5 训练脚本默认执行阶段 A（复原）。
- 进入阶段 B 后，切换 valpack LR 目录为 lq128，并在训练数据侧引入 lq128 输入（或上采样至 512 后输入）。

